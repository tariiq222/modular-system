# اختبارات وحدة الملفات الشخصية (Profiles Module Tests)

تم تنفيذ مجموعة من الاختبارات للتحقق من صحة وظائف وحدة الملفات الشخصية:

## اختبارات الـ DTO (Data Transfer Objects)

1. **اختبارات `CreateProfileDto`**:
   - التحقق من صحة جميع الحقول الاختيارية عند إدخالها بشكل صحيح
   - التحقق من قبول DTO فارغ (جميع الحقول اختيارية)
   - التحقق من رفض أرقام الهواتف غير الصالحة
   - التحقق من رفض روابط الويب غير الصالحة
   - التحقق من رفض أنواع الجنس غير المعرفة في التعداد
   - التحقق من قبول جميع أنواع الجنس المعرفة في التعداد

## اختبارات الخدمة (Service)

2. **اختبارات `ProfileService`**:
   - إنشاء ملف شخصي جديد
   - تحديث ملف شخصي موجود مسبقًا
   - التحقق من رمي استثناء عند عدم وجود المستخدم
   - البحث عن ملف شخصي بواسطة معرف المستخدم
   - رمي استثناء عند عدم وجود الملف الشخصي
   - تحديث ملف شخصي بواسطة معرف المستخدم
   - إنشاء ملف شخصي إذا لم يكن موجودًا مسبقًا
   - تحديث صورة الملف الشخصي

## اختبارات وحدة التحكم (Controller)

3. **اختبارات `ProfileController`**:
   - الحصول على الملف الشخصي للمستخدم الحالي
   - تحديث الملف الشخصي للمستخدم الحالي
   - رفع صورة الملف الشخصي
   - الحصول على تفضيلات المستخدم
   - الحصول على تفضيلات مصنفة حسب الفئة
   - إنشاء تفضيل جديد
   - الحصول على أنشطة المستخدم

## اختبارات التكامل (Integration Tests)

4. **اختبارات تكامل نهاية إلى نهاية (E2E)**:
   - اختبار نقطة نهاية GET /profiles/me
   - اختبار نقطة نهاية PUT /profiles/me
   - اختبار التحقق من البيانات قبل التحديث
   - اختبار نقطة نهاية GET /profiles/me/preferences
   - اختبار نقطة نهاية POST /profiles/me/preferences
   - اختبار نقطة نهاية GET /profiles/me/activities
   
## كيفية تشغيل الاختبارات

يمكن تشغيل اختبارات وحدة الملفات الشخصية باستخدام الأوامر التالية:

```bash
# تشغيل جميع الاختبارات
npm test

# تشغيل اختبارات وحدة الملفات الشخصية فقط
npm test -- src/modules/profiles

# تشغيل اختبارات DTO فقط
npm test -- src/modules/profiles/dtos

# تشغيل اختبارات الخدمة فقط
npm test -- src/modules/profiles/services

# تشغيل اختبارات وحدة التحكم فقط
npm test -- src/modules/profiles/controllers
```

## ملاحظات هامة

- لتشغيل اختبارات التكامل، يجب التأكد من وجود مستخدم اختبار في قاعدة البيانات، أو تعديل الاختبار ليتخطى المصادقة
- يمكن إضافة المزيد من الاختبارات لتغطية المزيد من حالات الاستخدام، مثل اختبارات رفع الصور والتعامل مع الملفات
- يجب التأكد من تهيئة بيئة الاختبار بشكل مناسب قبل تشغيل الاختبارات